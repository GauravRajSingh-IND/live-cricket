series_data = {
    "matchDetails": [
        {
            "matchDetailsMap": {
                "key": "Thu, 19 Sep 2024 - Mon, 23 Sep 2024",
                "match": [
                    {
                        "matchInfo": {
                            "matchId": 100220,
                            "seriesId": 8393,
                            "seriesName": "Bangladesh tour of India, 2024",
                            "matchDesc": "1st Test",
                            "matchFormat": "TEST",
                            "startDate": "1726718400000",
                            "endDate": "1727089200000",
                            "state": "Stumps",
                            "status": "Day 3: Stumps - Bangladesh need 357 runs",
                            "team1": {
                                "teamId": 2,
                                "teamName": "India",
                                "teamSName": "IND",
                                "imageId": 172115,
                            },
                            "team2": {
                                "teamId": 6,
                                "teamName": "Bangladesh",
                                "teamSName": "BAN",
                                "imageId": 172120,
                            },
                            "venueInfo": {
                                "id": 11,
                                "ground": "MA Chidambaram Stadium",
                                "city": "Chennai",
                                "timezone": "+05:30",
                            },
                            "currBatTeamId": 6,
                            "seriesStartDt": "1726704000000",
                            "seriesEndDt": "1728864000000",
                            "isTimeAnnounced": True,
                            "isFantasyHandbookEnabled": True,
                        },
                        "matchScore": {
                            "team1Score": {
                                "inngs1": {
                                    "inningsId": 1,
                                    "runs": 376,
                                    "wickets": 10,
                                    "overs": 91.2,
                                },
                                "inngs2": {
                                    "inningsId": 3,
                                    "runs": 287,
                                    "wickets": 4,
                                    "overs": 64.0,
                                    "isDeclared": True,
                                },
                            },
                            "team2Score": {
                                "inngs1": {
                                    "inningsId": 2,
                                    "runs": 149,
                                    "wickets": 10,
                                    "overs": 47.1,
                                },
                                "inngs2": {
                                    "inningsId": 4,
                                    "runs": 158,
                                    "wickets": 4,
                                    "overs": 37.2,
                                },
                            },
                        },
                    }
                ],
                "seriesId": 8393,
            }
        },
        {
            "adDetail": {
                "name": "native_news_index_random_1",
                "layout": "native_large",
                "position": 1,
            }
        },
        {
            "matchDetailsMap": {
                "key": "Fri, 27 Sep 2024 - Tue, 01 Oct 2024",
                "match": [
                    {
                        "matchInfo": {
                            "matchId": 100229,
                            "seriesId": 8393,
                            "seriesName": "Bangladesh tour of India, 2024",
                            "matchDesc": "2nd Test",
                            "matchFormat": "TEST",
                            "startDate": "1727409600000",
                            "endDate": "1727780400000",
                            "state": "Upcoming",
                            "status": "Match starts at Sep 27, 04:00 GMT",
                            "team1": {
                                "teamId": 2,
                                "teamName": "India",
                                "teamSName": "IND",
                                "imageId": 172115,
                            },
                            "team2": {
                                "teamId": 6,
                                "teamName": "Bangladesh",
                                "teamSName": "BAN",
                                "imageId": 172120,
                            },
                            "venueInfo": {
                                "id": 32,
                                "ground": "Green Park",
                                "city": "Kanpur",
                                "timezone": "+05:30",
                            },
                            "seriesStartDt": "1726704000000",
                            "seriesEndDt": "1728864000000",
                            "isTimeAnnounced": True,
                            "isFantasyHandbookEnabled": True,
                        }
                    }
                ],
                "seriesId": 8393,
            }
        },
        {
            "matchDetailsMap": {
                "key": "Sun, 06 Oct 2024",
                "match": [
                    {
                        "matchInfo": {
                            "matchId": 100238,
                            "seriesId": 8393,
                            "seriesName": "Bangladesh tour of India, 2024",
                            "matchDesc": "1st T20I",
                            "matchFormat": "T20",
                            "startDate": "1728221400000",
                            "endDate": "1728234000000",
                            "state": "Upcoming",
                            "status": "Match starts at Oct 06, 13:30 GMT",
                            "team1": {
                                "teamId": 2,
                                "teamName": "India",
                                "teamSName": "IND",
                                "imageId": 172115,
                            },
                            "team2": {
                                "teamId": 6,
                                "teamName": "Bangladesh",
                                "teamSName": "BAN",
                                "imageId": 172120,
                            },
                            "venueInfo": {
                                "id": 1437820,
                                "ground": "New Madhavrao Scindia Cricket Stadium",
                                "city": "Gwalior",
                                "timezone": "+05:30",
                            },
                            "seriesStartDt": "1726704000000",
                            "seriesEndDt": "1728864000000",
                            "isTimeAnnounced": True,
                            "isFantasyHandbookEnabled": True,
                        }
                    }
                ],
                "seriesId": 8393,
            }
        },
        {
            "matchDetailsMap": {
                "key": "Wed, 09 Oct 2024",
                "match": [
                    {
                        "matchInfo": {
                            "matchId": 100247,
                            "seriesId": 8393,
                            "seriesName": "Bangladesh tour of India, 2024",
                            "matchDesc": "2nd T20I",
                            "matchFormat": "T20",
                            "startDate": "1728480600000",
                            "endDate": "1728493200000",
                            "state": "Upcoming",
                            "status": "Match starts at Oct 09, 13:30 GMT",
                            "team1": {
                                "teamId": 2,
                                "teamName": "India",
                                "teamSName": "IND",
                                "imageId": 172115,
                            },
                            "team2": {
                                "teamId": 6,
                                "teamName": "Bangladesh",
                                "teamSName": "BAN",
                                "imageId": 172120,
                            },
                            "venueInfo": {
                                "id": 51,
                                "ground": "Arun Jaitley Stadium",
                                "city": "Delhi",
                                "timezone": "+05:30",
                            },
                            "seriesStartDt": "1726704000000",
                            "seriesEndDt": "1728864000000",
                            "isTimeAnnounced": True,
                            "isFantasyHandbookEnabled": True,
                        }
                    }
                ],
                "seriesId": 8393,
            }
        },
        {
            "adDetail": {
                "name": "native_news_index_random_2",
                "layout": "native_large",
                "position": 4,
            }
        },
        {
            "matchDetailsMap": {
                "key": "Sat, 12 Oct 2024",
                "match": [
                    {
                        "matchInfo": {
                            "matchId": 100256,
                            "seriesId": 8393,
                            "seriesName": "Bangladesh tour of India, 2024",
                            "matchDesc": "3rd T20I",
                            "matchFormat": "T20",
                            "startDate": "1728739800000",
                            "endDate": "1728752400000",
                            "state": "Upcoming",
                            "status": "Match starts at Oct 12, 13:30 GMT",
                            "team1": {
                                "teamId": 2,
                                "teamName": "India",
                                "teamSName": "IND",
                                "imageId": 172115,
                            },
                            "team2": {
                                "teamId": 6,
                                "teamName": "Bangladesh",
                                "teamSName": "BAN",
                                "imageId": 172120,
                            },
                            "venueInfo": {
                                "id": 80,
                                "ground": "Rajiv Gandhi International Stadium",
                                "city": "Hyderabad",
                                "timezone": "+05:30",
                            },
                            "seriesStartDt": "1726704000000",
                            "seriesEndDt": "1728864000000",
                            "isTimeAnnounced": True,
                            "isFantasyHandbookEnabled": True,
                        }
                    }
                ],
                "seriesId": 8393,
            }
        },
    ],
    "appIndex": {
        "seoTitle": "Bangladesh tour of India, 2024 live scores, schedule and results - Cricbuzz | Cricbuzz.com",
        "webURL": "www.cricbuzz.com/cricket-series/",
    },
}

def get_number_of_matches(series_data):
    """
    This function takes series data and return number of matches played in the series
    :param series_data:
    :return:
    """

    length = len(series_data['matchDetails'])

    number_matches = 0
    date = []
    match_id = []
    match_desc = []
    match_format = []
    match_state = []
    match_status = []
    # loop over each list to check number of matches.
    for match in range(length):

        # check keys
        if 'matchDetailsMap' in series_data['matchDetails'][match].keys():
            number_matches += 1
            date.append(series_data['matchDetails'][match]['matchDetailsMap']['key'])
            match_id.append(series_data['matchDetails'][match]['matchDetailsMap']['match'][0]['matchInfo']['matchId'])
            match_desc.append(series_data['matchDetails'][match]['matchDetailsMap']['match'][0]['matchInfo']['matchDesc'])
            match_format.append(series_data['matchDetails'][match]['matchDetailsMap']['match'][0]['matchInfo']['matchFormat'])
            match_state.append(series_data['matchDetails'][match]['matchDetailsMap']['match'][0]['matchInfo']['state'])
            match_status.append(series_data['matchDetails'][match]['matchDetailsMap']['match'][0]['matchInfo']['status'])

    return {"Number_Matches":number_matches, "date":date, "match_id":match_id, "match_description":match_desc,
            "match_format":match_format, "match_state":match_state, "match_status":match_status}

print(get_number_of_matches(series_data))
#get_number_of_matches(series_data)
